"use strict";var app=angular.module("bs-edit",[]);const EMPTY_VALUE="empty";app.directive("bseText",function(){return{restrict:"A",scope:{value:"=bseText",empty:"@",name:"@"},template:'<input name="{{name}}" ng-model="newValue" class="form-control"><span class="form-control" ng-class="{\'bse-empty\' : !value}" ng-bind="value || empty"></span>',link:function(e,n){e.empty=e.empty?e.empty:EMPTY_VALUE,n.addClass("edit-in-place");var a=angular.element(n.children()[0]);n.bind("click",function(){e.newValue=angular.copy(e.value),e.$apply(),n.addClass("active"),a[0].focus()}),a.bind("blur",function(){e.value=e.newValue,e.$apply(),n.removeClass("active")}),a.bind("keydown",function(n){13===n.which&&(this.blur(),n.preventDefault()),27===n.which&&(e.newValue=e.value,this.blur(),n.preventDefault())})}}}),app.directive("bseSelect",function(){var e=function(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),setTimeout(function(){e.dispatchEvent(n)},1)};return{restrict:"A",scope:{value:"=bseSelect",onshow:"&",empty:"@",name:"@"},template:'<select name="{{name}}" ng-model="value" class="form-control" ng-options="v.name for v in values track by v.id"></select><span class="form-control" ng-class="{\'bse-empty\' : !value}" ng-bind="value.name || empty"></span>',link:function(n,a){n.empty=n.empty?n.empty:EMPTY_VALUE,a.addClass("edit-in-place");var t=angular.element(a.children()[0]),l=angular.element(a.children()[1]);l.bind("click",function(){n.onshow().then(function(l){n.values=l,a.addClass("active"),t[0].focus(),e(t[0])})}),t.bind("blur",function(){n.$apply(),a.removeClass("active")}),t.bind("change",function(e){this.blur(),e.preventDefault()}),t.bind("keydown",function(e){27===e.which&&(this.blur(),e.preventDefault())})}}}),app.directive("bseTextarea",function(){return{restrict:"A",scope:{value:"=bseTextarea",empty:"@",name:"@"},template:'<textarea name="{{name}}" ng-model="newValue" class="form-control"></textarea><pre ng-class="{\'bse-empty\' : !value}" ng-bind="value || empty"></pre>',link:function(e,n){e.empty=e.empty?e.empty:EMPTY_VALUE,n.addClass("edit-in-place");var a=angular.element(n.children()[0]),t=angular.element(n.children()[1]);t.bind("click",function(){a[0].style.height=n[0].offsetHeight+"px",e.newValue=angular.copy(e.value),e.$apply(),n.addClass("active"),a[0].focus()}),a.bind("blur",function(){e.value=e.newValue,e.$apply(),n.removeClass("active")}),a.bind("keydown",function(n){if(13===n.which){var t=a[0].offsetHeight+20;a[0].style.height=t+"px"}27===n.which&&(e.newValue=e.value,this.blur(),n.preventDefault())})}}}),app.directive("bseDate",function(e){return{restrict:"A",scope:{value:"=bseDate",empty:"@",locale:"=",name:"@"},template:'<input name="{{name}}" ng-model="name" class="form-control"><span class="form-control" ng-class="{\'bse-empty\' : !value}">{{(value | date: "dd-MM-yyyy") || empty}}</span>',link:function(n,a){function t(){l.datepicker(c).attr("readonly","readonly")}n.empty=n.empty?n.empty:EMPTY_VALUE,a.addClass("edit-in-place");var l=angular.element(a.children()[0]),i=angular.element(a.children()[1]),c={language:n.locale,format:"dd-mm-yyyy",orientation:"bottom auto",todayHighlight:!0,autoclose:!0,clearBtn:!0};n.$watch("locale",function(n){angular.extend(c,{language:n}),e(function(){l.datepicker("remove"),t()})}),i.bind("click",function(){l.datepicker("setDate",n.value),a.addClass("active"),l[0].focus()}),l.bind("hide",function(e){a.removeClass("active"),n.value=e.date,n.$apply()})}}});
